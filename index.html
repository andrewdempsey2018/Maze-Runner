<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

	<!-- Title that will appear in browser tab -->
    <title>Maze Runner</title>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	<!-- Use CDN version of D3 -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>

	<!-- Import levels.js (contains multidimensioal arrays that hold data for layout of levels) -->
	<script type="text/javascript" src="assets/levels.js"></script>
	
	<!-- Stylesheet import -->
	<link rel="stylesheet" type="text/css" href="css/styles.css">

</head>
<body>

	<div class="container">
		<div class="row" id="titleArea">
			<h1>Maze Runner</h1>
		</div>
	</div>

<!-- This container houses the playarea div. This div houses all of the animations that make up the game -->
	<div class="container">
		<div class="row" id="playArea">
		</div>
	</div>

	<div class="container">
		<div class="row" id="UI">
			 <button type="button">Click Me!</button> 
		</div>
	</div>

	<script>

	/* create a canvas for d3 to render onto
	attach it to the body dom element and give
	it a width and height that suit both mobile
	and desktop enviornments */
    var scene = d3.select("#playArea").append("svg")
        .attr("width", 640)
        .attr("height", 480)
		/* COMMENT ON VIEWBOX */
		.attr("viewBox", `0 0 640 480`)
		.on("click", move);

	/* These variables will hold the x and y postitions
	of the player character. They are set to an initial value
	of 0, 32. This means the player will start in the top left
	of the screen */
	var playerX = 0;
	var playerY = 32;	

	/* */
	const PLAYER_WIDTH = 32;
	const PLAYER_HEIGHT = 32;

	const TILE_WIDTH = 32;
	const TILE_HEIGHT = 32;
	
	const TILES_ACROSS = 20;
	const TILES_DOWN = 15;

	/* */
	class Tile
	{
		constructor(x, y)
		{
			this.sprite =  scene.append("rect")
				.attr("x", x)
                .attr("y", y)
                .attr("width", TILE_WIDTH)
		        .attr("height", TILE_HEIGHT)
				.attr('fill', '#666666');
		}
	}

	var tileCounter = 0;
	var tiles = [];

	for(var i = 0; i < TILES_ACROSS; i++)
	{
		for(var j = 0; j < TILES_DOWN; j++)
		{
			if(level1[j][i] == 1)
			{
			    //document.write(level1[j][i]);
				tiles[tileCounter] = new Tile(i * TILE_HEIGHT, j * TILE_WIDTH);
			}
		}

		tileCounter++;
	}
	
	var player = scene.append("rect")
		.attr("id", "player")
        .attr("x", playerX)
        .attr("y", playerY)
        .attr("width", 32)
		.attr("height", 32)
		.attr('fill', '#17c200')

	function move()
	{
		/* */
		var mouse = d3.mouse(this);

		var destX = getGridPosition(mouse[0]);
		var destY = getGridPosition(mouse[1]);

		if(mouse[1] > playerY && mouse[1] < (playerY + PLAYER_HEIGHT))
		{
 

			player.attr("x", playerX);
		
			playerX = destX;
		}

		if(mouse[0] > playerY && mouse[0] < (playerX + PLAYER_HEIGHT))
		{
 

			player.attr("y", playerY);
		
			playerY = destY;
		}

		d3.select("#player")
				.transition()
				.duration(2000)
				.attr("y", destY)
				.attr("x", destX);

		window.requestAnimationFrame();
	};

	function getGridPosition(object)
	{
		var gridPosition = Math.floor(object / TILE_WIDTH);
		return gridPosition * TILE_WIDTH;
	}

	</script>

</body>
</html>